# Security Configuration for Uploads Directory
# Prevent direct access to uploaded files
# Files should only be served through serve_file.php with authentication

# Deny all direct access
<IfModule mod_authz_core.c>
    Require all denied
</IfModule>

# For older Apache versions
<IfModule !mod_authz_core.c>
    Order deny,allow
    Deny from all
</IfModule>

# Prevent directory listing
Options -Indexes

# Prevent execution of PHP files in uploads directory
<FilesMatch "\.php$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</FilesMatch>

# Allow only specific image and PDF file types
<FilesMatch "\.(jpg|jpeg|png|gif|pdf|webp)$">
    # Files still require authentication through serve_file.php
    # This just ensures only valid file types exist here
</FilesMatch>
